# 基金定投系统

## 功能概述

这是一个自动化的基金定投系统，主要功能包括：

1. **数据获取**：使用 Selenium 从东方财富网爬取基金排行数据
2. **基金筛选**：基于多维度指标筛选优质基金
3. **定投执行**：模拟定投操作并生成报告
4. **定时任务**：支持定时执行定投策略

## 风险调整收益计算方法

### 改进前（已移除）
```python
# 旧方法：使用日增长率（不推荐）
风险调整收益 = 近3年收益率 / (日增长率绝对值 * 100)
```

### 改进后（当前使用）
```python
# 方法1：使用波动率（推荐）
if 有多个时间段收益率数据:
    波动率 = 标准差(近1年, 近6月, 近3月, 近1月)
    风险调整收益 = 近3年收益率 / (波动率 + 0.01)

# 方法2：使用手续费作为风险代理
else:
    风险调整收益 = 近3年收益率 / (手续费 + 1)
```

### 为什么改进？

1. **日增长率问题**：
   - 单日波动太大，不能代表长期风险
   - 时间维度不匹配（3年 vs 1日）
   - 受市场情绪影响，不稳定

2. **新方法的优势**：
   - **波动率方法**：类似夏普比率，更科学
   - **手续费代理**：费率通常与风险正相关
   - **时间一致性**：使用相同时间维度的数据

## 综合评分模型

```python
收益评分 = (近3年收益率 / 最大值) * 40
风险评分 = (风险调整收益 / 最大值) * 30  
费率评分 = (1 - 手续费 / 最大值) * 20
综合评分 = 收益评分 + 风险评分 + 费率评分
```

## 使用方法

1. 安装依赖：
```bash
pip install -r requirements.txt
```

2. 运行程序：
```bash
python3 index.py
```

## 数据文件

- `data/fund_ranking_data.csv`：爬取的基金排行数据
- `bond_fund_investment_history.csv`：定投历史记录

## 注意事项

- 基金代码始终保持字符串格式，避免前导零丢失
- 自动处理数据中的 "---" 等特殊字符
- 添加随机延迟避免被反爬虫机制封禁 